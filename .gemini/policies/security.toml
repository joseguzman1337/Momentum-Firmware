# Security policies for Momentum Firmware

# Block access to sensitive files
[[rule]]
toolName = ["read_file", "write_file", "replace"]
argsPattern = '(\.ssh/|\.aws/|\.env|password|secret|key\.pem)'
decision = "deny"
priority = 950

# Allow security scanning tools
[[rule]]
toolName = "run_shell_command"
commandPrefix = ["bandit", "semgrep", "codeql", "snyk"]
decision = "allow"
priority = 400

# Require confirmation for network operations
[[rule]]
toolName = "run_shell_command"
commandPrefix = ["curl", "wget", "nc ", "nmap"]
decision = "ask_user"
priority = 350

# Allow firmware flashing with confirmation
[[rule]]
toolName = "run_shell_command"
commandPrefix = ["./fbt flash", "st-flash", "openocd"]
decision = "ask_user"
priority = 500

# Block system modification commands
[[rule]]
toolName = "run_shell_command"
commandPrefix = ["systemctl", "service ", "/etc/", "/usr/bin/"]
decision = "deny"
priority = 850